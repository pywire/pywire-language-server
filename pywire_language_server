#!/usr/bin/env python3
"""Entry point for PyWire Language Server"""
import sys
import json
import time
from pathlib import Path

# #region agent log
try:
    with open('/Users/rholmdahl/projects/pywire/.cursor/debug.log', 'a') as f:
        log_entry = {
            "sessionId": "debug-session",
            "runId": "run1",
            "hypothesisId": "H3",
            "location": "pywire_language_server:start",
            "message": "Server process started",
            "data": {
                "sys.executable": sys.executable,
                "sys.prefix": sys.prefix,
                "sys.path": sys.path,
                "cwd": str(Path.cwd())
            },
            "timestamp": int(time.time() * 1000)
        }
        f.write(json.dumps(log_entry) + "\n")
except Exception:
    pass
# #endregion

# Add src to path so we can import pywire_language_server
sys.path.insert(0, str(Path(__file__).parent / 'src'))

from pywire_language_server.server import start

if __name__ == '__main__':
    start()